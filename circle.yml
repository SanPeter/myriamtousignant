test:
  pre:
    - hexo clean
    - gulp generate
  override:
    - mkdir -p $CIRCLE_TEST_REPORTS
    - gulp test
    - cp ./backstop_data/ci_report_pages/* $CIRCLE_TEST_REPORTS/
    - cp ./backstop_data/ci_report_projets/* $CIRCLE_TEST_REPORTS/
    - cp ./backstop_data/ci_report_posts/* $CIRCLE_TEST_REPORTS/

deployment:
  production:
    branch: master
    commands:
      - sudo apt-get install lftp
      - lftp -c "set ftp:ssl-allow false;set ftp:list-options -a;open $FTP_URL;lcd ./public;cd $REMOTE_PATH;mirror --reverse --use-cache --verbose --allow-chown --allow-suid --no-umask --parallel=2 --only-newer --ignore-time --exclude-glob .git;"
 